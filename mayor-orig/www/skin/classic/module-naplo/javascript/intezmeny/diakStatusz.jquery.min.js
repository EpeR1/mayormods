
$(function() {
    $('select.zaradek').change(function(event) {
	element = $(event.target);
	if (element.val() == '') {
		element.closest('form').find('input[type=submit]').hide();
		element.next('div').html('');
	} else {
		var zArray = element.prop('options')[element.prop('selectedIndex')].innerHTML.split('%');
		var zTxt = '<p>';
		var tableTxt = '<table>';
		for (i=0;i<zArray.length;i++) {
		    if (i % 2 == 0) {
			zTxt = zTxt + zArray[i];
		    } else {
			zTxt = zTxt + '<span id="'+element.attr('id')+i+'span'+'">'+zArray[i]+'</span>';
			tableTxt = tableTxt + '<tr><th><label for="'+element.attr('id')+i+'">'+zArray[i]+'</label></th>';
			tableTxt = tableTxt + '<td><input type="text" name="values[]" value="" id="'+element.attr('id')+i+'" class="onChangeReplaceSpan" /></td></tr>';
		    }
		}
		tableTxt = tableTxt + '</table>';
		zTxt = '<p>' + zTxt + '</p>' + tableTxt;
		element.next('div').html(zTxt);
		element.next('div').find('table input[type=text]').change(function(event) {
    			    var element = $(event.target);
			    $('#'+element.attr('id')+'span').innerHTML=element.val().escapeHTML(); 
		});
    		element.closest('form').find('input[type=submit]').show();	
	}
    });
});
