
hideOptions = function(event) {
    element = $(event.target);
    if (element.hasClass('jegyTipus')) {
	    var jegyek = element.next('select');
	    if (element.context.selectedIndex == 0) {
		jegyek.find('*').prop('disabled',false).show();
	    } else {
		$(jegyek).val([]);
		$(jegyek).find('*').prop('disabled','disabled').hide();
		$(jegyek).find('option:first').prop('disabled',false).show()
		var selector='optgroup[label="'+element.val()+'"]';
		jegyek.find(selector).prop('disabled',false).show().find('option').prop('disabled',false).show();
	    }
    }
    if (element.hasClass('jegyAdat')) {
	    var tipusok = $(element.parents('.hideShowContainer')[0]).find('.jegyTipus')[0];
	    var jegyTipus = $(element[0].options[element[0].selectedIndex]).parents('optgroup')[0].label;
	    index = 0;
	    while (tipusok.options[index].value != jegyTipus && index < tipusok.options.length && index < 100) index++;
	    if (index < tipusok.options.length) tipusok.selectedIndex=index;
	    else tipusok.selecedIndex=0;
    }
}

$(function() {
	// Halasztás elrejtése
	$('div.rejtett').hide();
	$('body').bind('click', function(event) {
	    element = $(event.target);

	    // értékeléskor...
    	    if (element.hasClass('ertekeles')) {
                // ... a halasztasDt üresreállítása
		$(element.parents(".hideShowContainer")[0]).find('input.halasztasDt').prop('value','');
    	    }
	    // halasztáskor...

    	    if (element.hasClass('halasztas')) {
		// ... a jegytípus/jegy kiválasztást megszüntetjük
		// $(element.parents('.hideShowContainer')[0]).find('.jegyTipus')[0].selectedIndex=0;
		// $(element.parents('.hideShowContainer')[0]).find('.jegyAdat')[0].selectedIndex=0;
		$(element.parents('.hideShowContainer')[0]).find('select').prop('selectedIndex',-1).val([]);
		$(element.parents('.hideShowContainer')[0]).find('optgroup, option').prop('disabled',false).show();
	    }

	});
	$('body').bind('change', hideOptions);
	$('body').bind('mayor:change', hideOptions);
});
